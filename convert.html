<!DOCTYPE html>
<html lang="ko">
<head>
  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2824624880449066"
     crossorigin="anonymous"></script>
  <!-- 페이지 기본 설정 -->
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <!-- SEO / 메타 설정 -->
  <title>FreeComfortLab – 파일 변환 실험실</title>
  <meta name="description" content="파일 변환 실험 페이지 (UI 테스트 단계)" />

  <!-- 스타일 정의 -->
  <style>
    body {
      margin: 0;
      padding: 0;
      background: #0e1016;
      font-family: 'Pretendard', sans-serif;
      color: #fff;
    }

    a { text-decoration: none; color: #9aa4c6; }

    .page-wrapper {
      max-width: 900px;
      margin: 0 auto;
      padding: 40px 20px;
    }

    .card {
      background: #1b1f27;
      border-radius: 12px;
      padding: 24px;
      border: 1px solid #2a2f3a;
    }

    h1 {
      font-size: 28px;
      margin-bottom: 4px;
      font-weight: 700;
    }

    .sub-text {
      font-size: 14px;
      color: #9aa4c6;
      margin-bottom: 28px;
    }

    .btn-back {
      display: inline-block;
      margin-bottom: 20px;
      padding: 6px 12px;
      border-radius: 8px;
      background: #2a2f3a;
      font-size: 14px;
    }

    .label {
      font-size: 14px;
      margin-bottom: 6px;
      display: block;
    }

    input, select {
      width: 100%;
      padding: 10px 12px;
      border-radius: 8px;
      border: 1px solid #3a3f4a;
      background: #12141a;
      color: #fff;
      margin-bottom: 20px;
    }

    button {
      width: 100%;
      padding: 12px;
      border-radius: 8px;
      border: none;
      background: #4f8cff;
      font-size: 15px;
      font-weight: 600;
      cursor: pointer;
    }

    button:disabled {
      background: #3c4b6b;
      cursor: not-allowed;
    }

    .hint {
      font-size: 13px;
      color: #8c94a6;
      margin-top: 20px;
      line-height: 1.6;
    }
  </style>
</head>

<body>
  <!-- 페이지 전체 래퍼 -->
  <div class="page-wrapper">

    <!-- 헤더 + 뒤로가기 -->
    <a href="/" class="btn-back">← 메인으로 돌아가기</a>

    <h1>파일 변환 실험실</h1>
    <div class="sub-text">
      1차 버전 – UI 배대 상태. 아직 실제 변환 서버와 연결 전입니다.
    </div>

    <!-- 파일 업로드 & 옵션 카드 -->
    <div class="card">

      <div class="label">파일 업로드 & 포맷 선택</div>
      <div class="hint">
        아래 UI는 나중에 Flask 변환 서버와 Cloudflare Worker가 연결됩니다.<br />
        지금은 “요청하기” 단계이며 실제 변환 동작은 아직 포함되지 않은 상태입니다.
      </div>

      <!-- 업로드 / 포맷 선택 폼 -->
      <form>
        <label class="label">1. 파일 선택</label>
        <input type="file" name="input_file" />

        <label class="label">2. 변환 포맷</label>
        <select name="format">
          <option value="original">원본 유지</option>
          <option value="mp4">mp4로 변환</option>
          <option value="mp3">mp3로 변환</option>
          <option value="wav">wav로 변환</option>
        </select>

        <button type="submit">변환 요청 (앞으로 연결 자리)</button>
      </form>

      <div class="hint">
        지금 단계는 UI 스케치 단계입니다.<br />
        뒤에서 Flask 서버 + FFmpeg + Cloudflare Workers를 연결하여  
        실제 파일을 업로드하고 변환하고 다운로드 링크를 돌려주는 로직을 붙일 예정입니다.
      </div>

    </div>
  </div>

  <!-- ▼▼ /api/convert 연결을 위한 스크립트 ▼▼ -->
  <script>
    document.addEventListener("DOMContentLoaded", function () {
      const form = document.querySelector("form");
      const fileInput = document.querySelector('input[type="file"]');
      const formatSelect = document.querySelector("select");
      const submitButton = document.querySelector('button[type="submit"]');

      let resultBox = document.getElementById("convert-result-box");
      if (!resultBox) {
        resultBox = document.createElement("div");
        resultBox.id = "convert-result-box";
        resultBox.style.marginTop = "20px";
        resultBox.style.fontSize = "14px";
        resultBox.style.color = "#8c94a6";
        form.parentNode.appendChild(resultBox);
      }

      form.addEventListener("submit", async (event) => {
        event.preventDefault();

        if (!fileInput.files.length) {
          resultBox.textContent = "먼저 업로드할 파일을 선택하세요.";
          return;
        }

        const file = fileInput.files[0];
        const format = formatSelect.value || "original";

        submitButton.disabled = true;
        submitButton.textContent = "변환 요청 중…";

        const formData = new FormData();
        formData.append("file", file);
        formData.append("format", format);

        try {
          const response = await fetch("/api/convert", {
            method: "POST",
            body: formData,
          });

          const data = await response.json();
          resultBox.textContent = "서버 응답: " + JSON.stringify(data, null, 2);
        } catch (err) {
          resultBox.textContent = "요청 오류: " + err.message;
        } finally {
          submitButton.disabled = false;
          submitButton.textContent = "변환 요청 (앞으로 연결 자리)";
        }
      });
    });
  </script>
  <!-- ▲▲ 스크립트 끝 ▲▲ -->

</body>
</html>
